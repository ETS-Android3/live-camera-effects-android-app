webpackJsonp([1],{NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("7+uW"),r=n("cp2t"),i=n.n(r),a={name:"App",data:function(){return{selectedMode:null,modes:[{name:"Default",key:"identity"},{name:"Invert",key:"invert"},{name:"Color shift",key:"colorShift"},{name:"Vertical mirror",key:"verticalMirror"},{name:"Horizontal mirror",key:"horizontalMirror"},{name:"Kaleidoscope 4",key:"kaleidoscope4"},{name:"Kaleidoscope 6",key:"kaleidoscope6"},{name:"Sharpen",key:"convolve",uniforms:{kernel:[0,-3,0,-3,13,-3,0,-3,0]},argument:"kernel"},{name:"Edge detection",key:"convolve",uniforms:{kernel:[1,1,1,1,-8,1,1,1,1]},argument:"kernel"}],menu:!1,tx:null,captureNextFrame:!1,facingMode:"environment",animating:!1,mediaStream:null}},watch:{selectedMode:function(t){this.tx=new i.a({input:document.getElementById("video"),shader:"uniforms"in this.selectedMode&&"argument"in this.selectedMode?i.a.shaders[this.selectedMode.key](this.selectedMode.uniforms[this.selectedMode.argument]):i.a.shaders[this.selectedMode.key](),output:document.getElementById("canvas"),uniforms:this.selectedMode.uniforms}),this.menu=!1},facingMode:function(t){this.startStreaming()}},methods:{dataURItoBlob:function(t){var e;e=t.split(",")[0].indexOf("base64")>=0?atob(t.split(",")[1]):unescape(t.split(",")[1]);for(var n=t.split(",")[0].split(":")[1].split(";")[0],o=new Uint8Array(e.length),r=0;r<e.length;r++)o[r]=e.charCodeAt(r);return new Blob([o],{type:n})},saveFrame:function(t){var e="capture_"+Date.now()+".png";if("cordova"in window){var n=this.dataURItoBlob(t);window.resolveLocalFileSystemURL("file:///storage/emulated/0/Download",function(t){t.getFile(e,{create:!0},function(t){t.createWriter(function(t){t.write(n),alert("Photo saved to Download folder ("+e+")")},function(t){console.log(t)})})})}else{var o=document.createElement("a");o.href=t,o.download=e,o.click()}},animate:function(){if(this.tx.render(),this.captureNextFrame){this.captureNextFrame=!1;var t=document.getElementById("canvas").toDataURL();this.saveFrame(t)}window.requestAnimationFrame(this.animate)},startStreaming:function(){var t=this;this.mediaStream&&this.mediaStream.getTracks().forEach(function(t){return t.stop()});var e={audio:!1,video:{facingMode:this.facingMode}};navigator.mediaDevices.getUserMedia(e).then(function(e){t.mediaStream=e;var n=document.getElementById("video");n.srcObject=e,n.onloadedmetadata=function(e){n.play(),t.tx=new i.a({input:n,shader:"uniforms"in t.selectedMode&&"argument"in t.selectedMode?i.a.shaders[t.selectedMode.key](t.selectedMode.uniforms[t.selectedMode.argument]):i.a.shaders[t.selectedMode.key](),output:document.getElementById("canvas"),uniforms:t.selectedMode.uniforms}),t.animating||(t.animating=!0,t.animate())}}).catch(function(t){console.log(t.name+": "+t.message)})}},mounted:function(){var t=this;this.selectedMode=this.modes[0],"cordova"in window?document.addEventListener("deviceready",function(){cordova.plugins.diagnostic.requestCameraAuthorization(function(e){e==cordova.plugins.diagnostic.permissionStatus.GRANTED?t.startStreaming():console.log("Camera permission denied")},function(t){console.log("Camera authorization error: "+t)},!1)}):this.startStreaming()}},s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("video",{staticStyle:{display:"none"},attrs:{id:"video"}}),t._v(" "),t._m(0),t._v(" "),t.menu?n("div",{attrs:{id:"menu"}},[n("div",{attrs:{id:"menu-header"}},[t._v("Choose mode")]),t._v(" "),n("div",{staticClass:"menu-items"},t._l(t.modes,function(e){return n("div",{class:"menu-item"+(t.selectedMode.key==e.key?" menu-item-selected":""),on:{click:function(n){t.selectedMode=e}}},[t._v("\n        "+t._s(e.name)+"\n      ")])}),0)]):t._e(),t._v(" "),t.menu?t._e():n("div",{attrs:{id:"top"}},[n("div",{staticClass:"top-item"},[n("i",{staticClass:"material-icons",on:{click:function(e){t.menu=!0}}},[t._v("menu")])]),t._v(" "),n("div",{staticClass:"top-item"},["environment"==t.facingMode?n("i",{staticClass:"material-icons",on:{click:function(e){t.facingMode="user"}}},[t._v("portrait")]):t._e(),t._v(" "),"user"==t.facingMode?n("i",{staticClass:"material-icons",on:{click:function(e){t.facingMode="environment"}}},[t._v("landscape")]):t._e()]),t._v(" "),n("div",{staticClass:"top-item-right"},[n("i",{staticClass:"material-icons",on:{click:function(e){t.captureNextFrame=!0}}},[t._v("photo_camera")])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"canvas-container"}},[e("canvas",{attrs:{id:"canvas"}})])}]};var c=n("VU/8")(a,s,!1,function(t){n("wcip")},null,null).exports;o.a.config.productionTip=!1,new o.a({el:"#app",components:{App:c},template:"<App/>"})},cp2t:function(t,e,n){var o,r;r=function(){return function t(e,n,r){function i(s,c){if(!n[s]){if(!e[s]){if(!c&&("function"==typeof o&&o))return o(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return i(n||t)},l,l.exports,t,e,n,r)}return n[s].exports}for(var a="function"==typeof o&&o,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={identity:function(){return"\n\t\t\tprecision highp float;\n\t\t\tvarying vec2 texCoord;\n\t\t\tuniform sampler2D texture;\n\t\t\tvoid main() {\n\t\t\t\tgl_FragColor = texture2D(texture, texCoord);\n\t\t\t}\n\t\t"},invert:function(){return"\n\t\t\tprecision highp float;\n\t\t\tvarying vec2 texCoord;\n\t\t\tuniform sampler2D texture;\n\t\t\tvoid main() {\n\t\t\t\tvec4 color = texture2D(texture, texCoord);\n\t\t\t\tgl_FragColor = vec4(vec3(1.0 - color.rgb), color.a);\n\t\t\t}\n\t\t"},flip:function(){return"\n\t\t\tprecision highp float;\n\t\t\tvarying vec2 texCoord;\n\t\t\tuniform sampler2D texture;\n\t\t\tvoid main() {\n\t\t\t\tvec2 coord = vec2(1.0-texCoord.x, texCoord.y);\n\t\t\t\tvec4 color = texture2D(texture, coord);\n\t\t\t\tgl_FragColor = color;\n\t\t\t}\n\t\t"},blur:function(){return"\n\t\t\t#define radius 10\n\t\t\tprecision highp float;\n\t\t\tvarying vec2 texCoord;\n\t\t\tuniform vec2 resolution;\n\t\t\tuniform sampler2D texture;\n\t\t\tvoid main() {\n\t\t\t\tvec4 avg = vec4(0);\n\t\t\t\tint count = 0;\n\t\t\t\tfor (int i = -radius; i < radius; i++) {\n\t\t\t\t\tfor (int j = -radius; j < radius; j++) {\n\t\t\t\t\t\tif (i*i+j*j <= radius*radius) {\n\t\t\t\t\t\t\tavg += texture2D(\n\t\t\t\t\t\t\t\ttexture,\n\t\t\t\t\t\t\t\tvec2(texCoord.x + float(i)/resolution.x, texCoord.y + float(j)/resolution.y)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tcount += 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tavg = avg / float(count);\n\t\t\t\tgl_FragColor = avg;\n\t\t\t}\n\t\t"},kaleidoscope4:function(){return"\n\t\t\tprecision highp float;\n\t\t\tvarying vec2 texCoord;\n\t\t\tuniform sampler2D texture;\n\t\t\tuniform float time;\n\t\t\tvec2 Kaleidoscope( vec2 uv, float n) {\n\t\t\t\tfloat PI = 3.1415926535897932384626433832795;\n\t\t    float angle = PI / n;\n\t\t    float r = length( uv );\n\t\t    float a = atan( uv.y, uv.x ) / angle;\n\t\t    a = mix( fract( a ), 1.0 - fract( a ), mod( floor( a ), 2.0 ) ) * angle;\n\t\t    // radial = vec2(a, r);\n\t\t    return vec2( cos( a ), sin( a ) ) * r;\n\t\t  }\n\t\t\tvoid main() {\n\t\t\t\tfloat rotation = 0.0;\n\t\t\t\tfloat scale = 1.0;\n\t\t\t\tvec2 pos = vec2(0.5, 0.5);\n\t\t\t\tfloat blades = 4.0;\n\t\t\t\tvec2 uv = texCoord.xy - 0.5;\n\t\t\t\tvec2 k = Kaleidoscope(uv * mat2(cos(rotation), -sin(rotation), sin(rotation), cos(rotation)), blades);\n\t\t\t\tmat2 rm = mat2(cos(rotation), -sin(rotation), sin(rotation), cos(rotation));\n\t\t\t\tvec2 colour_k = rm * (k * scale + pos);\n\t\t\t\tvec4 color = texture2D(texture, colour_k);\n\t\t\t\tgl_FragColor = color;\n\t\t\t}\n\t\t"},kaleidoscope6:function(){return"\n\t\t\tprecision highp float;\n\t\t\tvarying vec2 texCoord;\n\t\t\tuniform sampler2D texture;\n\t\t\tuniform float time;\n\t\t\tvec2 Kaleidoscope( vec2 uv, float n) {\n\t\t\t\tfloat PI = 3.1415926535897932384626433832795;\n\t\t    float angle = PI / n;\n\t\t    float r = length( uv );\n\t\t    float a = atan( uv.y, uv.x ) / angle;\n\t\t    a = mix( fract( a ), 1.0 - fract( a ), mod( floor( a ), 2.0 ) ) * angle;\n\t\t    // radial = vec2(a, r);\n\t\t    return vec2( cos( a ), sin( a ) ) * r;\n\t\t  }\n\t\t\tvoid main() {\n\t\t\t\tfloat rotation = 0.0;\n\t\t\t\tfloat scale = 1.0;\n\t\t\t\tvec2 pos = vec2(0.5, 0.5);\n\t\t\t\tfloat blades = 6.0;\n\t\t\t\tvec2 uv = texCoord.xy - 0.5;\n\t\t\t\tvec2 k = Kaleidoscope(uv * mat2(cos(rotation), -sin(rotation), sin(rotation), cos(rotation)), blades);\n\t\t\t\tmat2 rm = mat2(cos(rotation), -sin(rotation), sin(rotation), cos(rotation));\n\t\t\t\tvec2 colour_k = rm * (k * scale + pos);\n\t\t\t\tvec4 color = texture2D(texture, colour_k);\n\t\t\t\tgl_FragColor = color;\n\t\t\t}\n\t\t"},zoom:function(){return"\n\t\t\t\tprecision highp float;\n\t\t\t\tuniform float x;\n\t\t\t\tuniform float y;\n\t\t\t\tuniform float factor;\n\t\t\t\tvarying vec2 texCoord;\n\t\t\t\tuniform sampler2D texture;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 coord = vec2((texCoord.x - x)/factor + x, (texCoord.y - y)/factor + y);\n\t\t\t\t\tvec4 color = texture2D(texture, coord);\n\t\t\t\t\tgl_FragColor = color;\n\t\t\t\t}\n\t\t"},convolve:function(t){return"\n\t\t\t#define size "+t.length+"\n\t\t\tprecision highp float;\n\t\t\tvarying vec2 texCoord;\n\t\t\tuniform sampler2D texture;\n\t\t\tuniform float kernel[size];\n\t\t\tuniform vec2 resolution;\n\t\t\tfloat intmod(float a, float b) {\n\t\t\t\t\tfloat m=a-floor((a+0.5)/b)*b;\n\t\t\t\t\treturn floor(m+0.5);\n\t\t\t}\n\t\t\tvoid main() {\n\t\t\t\tvec4 avg = vec4(0);\n\t\t\t\tint len = int(sqrt(float(size)));\n\t\t\t\tfloat total = 0.0;\n\t\t\t\tfor (int i = 0; i < size; i++) {\n\t\t\t\t\tint x = int(intmod(float(i), float(len)));\n\t\t\t\t\tint y = i / len;\n\t\t\t\t\tfloat weight = kernel[i];\n\t\t\t\t\tvec2 dp = vec2(float(x)-(float(len)-1.0)/(2.0), float(y)-(float(len)-1.0)/(2.0));\n\t\t\t\t\tavg += weight*texture2D(texture, texCoord + dp / resolution);\n\t\t\t\t}\n\t\t\t\tgl_FragColor = vec4(avg.xyz, 1.0);\n\t\t\t}\n\t\t"},verticalMirror:function(){return"\n\t\t\tprecision highp float;\n\t\t\tvarying vec2 texCoord;\n\t\t\tuniform sampler2D texture;\n\t\t\tvoid main() {\n\t\t\t\tfloat x;\n\t\t\t\tif (texCoord.x < 0.5) x = texCoord.x;\n\t\t\t\telse x = 1.0 - texCoord.x;\n\t\t\t\tvec4 color = texture2D(texture, vec2(x, texCoord.y));\n\t\t\t\tgl_FragColor = color;\n\t\t\t}\n\t\t"},horizontalMirror:function(){return"\n\t\t\tprecision highp float;\n\t\t\tvarying vec2 texCoord;\n\t\t\tuniform sampler2D texture;\n\t\t\tvoid main() {\n\t\t\t\tfloat y;\n\t\t\t\tif (texCoord.y < 0.5) y = texCoord.y;\n\t\t\t\telse y = 1.0 - texCoord.y;\n\t\t\t\tvec4 color = texture2D(texture, vec2(texCoord.x, y));\n\t\t\t\tgl_FragColor = color;\n\t\t\t}\n\t\t"},colorShift:function(){return"\n\t\t\tprecision highp float;\n\t\t\tvarying vec2 texCoord;\n\t\t\tuniform float time;\n\t\t\tuniform sampler2D texture;\n\t\t\tvec3 rgb2hsv(vec3 c) {\n\t\t    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n\t\t    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n\t\t    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\t\t    float d = q.x - min(q.w, q.y);\n\t\t    float e = 1.0e-10;\n\t\t    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n\t\t\t}\n\t\t\tvec3 hsv2rgb(vec3 c) {\n\t\t\t    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n\t\t\t    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n\t\t\t    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n\t\t\t}\n\t\t\tvoid main() {\n\t\t\t\tvec4 cin = texture2D(texture, texCoord);\n\t\t\t\tvec3 hsv = rgb2hsv(cin.rgb);\n\t\t\t\tvec3 cout = hsv2rgb(vec3(fract(hsv.x + time*0.1), hsv.y, hsv.z));\n\t\t\t\tgl_FragColor = vec4(cout, 1.0);\n\t\t\t}\n\t\t"},void:function(){return"\n\t\t\tprecision highp float;\n\t\t\tvoid main() {\n\t\t\t\tgl_FragColor = vec4(vec3(0), 1.0);\n\t\t\t}\n\t\t"}}},{}],2:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();var i=function(){function t(e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.initialized=!1,this.uniforms=e.uniforms||{},this.uniformLocations={},this.vertexShader="\n\t\t\tprecision highp float;\n\t\t\tattribute vec3 position;\n\t\t\tattribute vec2 coord;\n\t\t\tvarying vec2 texCoord;\n\t\t\tvoid main() {\n\t\t\t\ttexCoord = coord;\n\t\t\t  \tgl_Position = vec4(position, 1.0);\n\t\t\t}\n\t\t",this.time=0,this.dt=.01,this.program=null,this.gl=null,this.fragmentShader=e.shader,this.input=e.input,this.output=e.output,this}return r(t,[{key:"setupTexture",value:function(){var t=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),t}},{key:"initialize",value:function(){var t=this,e=this.output.getContext("webgl");this.gl=e;var n=e.createShader(e.VERTEX_SHADER);e.shaderSource(n,this.vertexShader),e.compileShader(n);var o=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(o,this.fragmentShader),e.compileShader(o);var r=e.getShaderInfoLog(o);r&&console.error(r),this.program=e.createProgram(),e.attachShader(this.program,n),e.attachShader(this.program,o),e.linkProgram(this.program),e.useProgram(this.program),this.setupTexture(),this.input&&e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this.input);var i=this.setupTexture(),a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0),e.bindFramebuffer(e.FRAMEBUFFER,null),this.uniformLocations.time=e.getUniformLocation(this.program,"time"),this.uniformLocations.resolution=e.getUniformLocation(this.program,"resolution"),this.uniformLocations.texture=e.getUniformLocation(this.program,"texture"),Object.keys(this.uniforms).forEach(function(n){t.uniformLocations[n]=e.getUniformLocation(t.program,n)});var s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,1,0,1,1,0,1,-1,0,-1,1,0,1,-1,0,-1,-1,0]),e.STATIC_DRAW);var c=e.getAttribLocation(this.program,"position");e.vertexAttribPointer(c,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(c);var u=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,u),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,0,1,1,0,1]),e.STATIC_DRAW);var l=e.getAttribLocation(this.program,"coord");l>=0&&(e.vertexAttribPointer(l,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(l)),this.initialized=!0}},{key:"render",value:function(){var t=this;this.initialized||this.initialize();var e=this.gl;return this.input&&e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this.input),e.uniform1i(this.uniformLocations.texture,0),e.uniform2f(this.uniformLocations.resolution,this.output.width,this.output.height),e.uniform1f(this.uniformLocations.time,this.time),Object.keys(this.uniforms).forEach(function(n){"number"==typeof t.uniforms[n]?e.uniform1f(t.uniformLocations[n],t.uniforms[n]):"object"===o(t.uniforms[n])?e.uniform1fv(t.uniformLocations[n],t.uniforms[n]):console.error("Error: unsupported uniform type ("+o(t.uniforms[n])+")")}),this.output.width=this.output.scrollWidth,this.output.height=this.output.scrollHeight,e.viewport(0,0,this.output.width,this.output.height),e.drawArrays(e.TRIANGLES,0,6),this.time+=this.dt,this}}]),t}();n.default=i,i.shaders=t("./shaders.js").default,i.uniforms=t("./uniforms.js").default,e.exports=i},{"./shaders.js":1,"./uniforms.js":3}],3:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={zoom:{x:.5,y:.5,factor:2}}},{}]},{},[2])(2)},t.exports=r()},wcip:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.b903cf22fbb9c7cd7069.js.map